[gcode_macro PRINT_START]
gcode:
  CLEAR_PAUSE

  {% set BED_TEMP = params.BED|default(105)|float %}
  {% set EXTRUDER_TEMP = params.EXTRUDER|default(250)|float %}

  BED_MESH_CLEAR        ; clear mesh

  M140 S{BED_TEMP}      ; start the bed heating
  M104 S{EXTRUDER_TEMP} ; start the extruder heating

  HOME_IF_NEEDED        ; home the printer
  PARKBED               ; move the head to the middle of the bed so it heat soaks

  M109 S{EXTRUDER_TEMP} ; wait for extruder to get up to temp
  M190 S{BED_TEMP}      ; wait for bed to be at temp

  G28 Z                 ; home again, now that the printer is warm

  ATTACH_PROBE_LOCK     ; dock and lock the klicky so it doesn't get put back after the QGL
  QUAD_GANTRY_LEVEL     ; QGL
  CALIBRATE_Z           ; auto find the correct Z offset
  DOCK_PROBE_UNLOCK     ; put the klicky away

  PRIME_LINE RESTORE=0 LENGTH=200
