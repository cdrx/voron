[gcode_macro HOME_IF_NEEDED]
gcode :
  {% if "xyz" not in printer.toolhead.homed_axes %}
    G28 XYZ
  {% else %}
    {action_respond_info("Homing skipped; all axis already homed")}
  {% endif %}
